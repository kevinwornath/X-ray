<script>
    let model;
  
    async function initializeModel() {
      const modelURL = 'https://raw.githubusercontent.com/kevinwornath/onnx/main/my_model.onnx';
      model = await onnx.Model.create(modelURL);
    }
  
    async function runModel() {
      const fileInput = document.getElementById('fileInput');
      const file = fileInput.files[0];
  
      const reader = new FileReader();
      reader.onload = async function(e) {
        const dataURL = e.target.result;
  
        const img = document.createElement('img');
        img.src = dataURL;
  
        const tensor = onnx.Tensor.fromImage(img);
        const preprocessed = tensor.resize([64, 64]).div(255);
  
        const outputMap = await model.predict({ input: preprocessed });
  
        const outputTensor = outputMap.values().next().value;
        const outputData = outputTensor.data;
        const classIndex = outputData.indexOf(Math.max(...outputData));
        const classNames = ['Normal', 'Pneumonia'];
        const predictionLabel = classNames[classIndex];
  
        const resultDiv = document.getElementById('result');
        resultDiv.textContent = `Prediction: ${predictionLabel}`;
      };
  
      reader.readAsDataURL(file);
    }
  </script>