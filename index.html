<!DOCTYPE html>
<html>
<head>
  <title>X-Ray Classification</title>
  <script src="https://cdn.jsdelivr.net/npm/onnxjs/dist/onnxruntime-web.js"></script>
  <script>
    async function runModel() {
      const modelURL = 'https://raw.githubusercontent.com/kevinwornath/onnx/main/my_model.onnx';

      const model = await onnx.Model.create(modelURL);

      const fileInput = document.getElementById('fileInput');
      const file = fileInput.files[0];

      const reader = new FileReader();
      reader.onload = function(e) {
        const dataURL = e.target.result;

        const img = document.createElement('img');
        img.src = dataURL;

        const tensor = onnx.Tensor.fromImage(img);
        const preprocessed = tensor.resize([64, 64]).div(255);

        const outputMap = model.predict({ input: preprocessed });

        const outputTensor = outputMap.values().next().value;
        const outputData = outputTensor.data;
        const classIndex = outputData.indexOf(Math.max(...outputData));
        const classNames = ['Normal', 'Pneumonia'];
        const predictionLabel = classNames[classIndex];

        const resultDiv = document.getElementById('result');
        resultDiv.textContent = `Prediction: ${predictionLabel}`;
      };

      reader.readAsDataURL(file);
    }
  </script>
</head>
<body>
  <h1>X-Ray Classification</h1>
  <input type="file" id="fileInput" accept=".jpg,.jpeg,.png">
  <button onclick="runModel()">Run Model</button>
  <div id="result"></div>
</body>
</html>